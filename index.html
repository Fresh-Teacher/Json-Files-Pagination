<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PDF Viewer</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
    }
    
    #pdf-container {
      height: calc(100vh - 100px);
      overflow: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    
    #pdf-canvas {
      border: 1px solid #333;
      max-width: 100%;
      max-height: 100%;
    }
    
    .nav-buttons {
      margin-top: 10px;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
    }
    
    .nav-button {
      margin: 0 5px;
      padding: 5px 10px;
      cursor: pointer;
    }

    .close-button {
      margin-left: 10px;
      margin-right: 10px;
      padding: 5px 10px;
      background-color: red;
      color: white;
      border: none;
      cursor: pointer;
    }

    .footer {
      background-color: #333;
      color: #fff;
      text-align: center;
      padding: 10px;
    }
  </style>
</head>
<body>
  <div id="pdf-links-container">
    <a href="https://freshteacher.software/Middle%20Numbers%20Term%20III%20Lesson%20Notes.pdf" class="pdf-link">Lesson Notes</a>
    <a href="https://freshteacher.software/wakisha%20Ent%203.pdf" class="pdf-link">Past Papers</a>
    <!-- Add more PDF file links as needed -->
  </div>

  <div id="pdf-container">
    <canvas id="pdf-canvas"></canvas>
    <div class="nav-buttons">
      <button class="btn btn-primary" id="prev-button" style="display: none;">&lt; Previous Page</button>
      <div id="page-numbers"></div>
      <button class="btn btn-primary" id="next-button">Next Page&gt;</button>
      <div>
        <button class="btn btn-secondary" id="zoom-in-button"><i class="fas fa-search-plus"></i> Zoom In</button>
        <button class="btn btn-secondary" id="zoom-out-button"><i class="fas fa-search-minus"></i> Zoom Out</button>
      </div>
      <button class="btn btn-danger close-button" id="close-button">Close Preview&#10006;</button>
    </div>
  </div>

  <div class="footer" id="footer">&copy; Fresh Teacher Software <span id="current-year"></span></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.min.js"></script>
  <script>
    let pdf = null;
    let currentPage = 1;
    let currentZoom = 1;

    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.11.338/pdf.worker.min.js';

    function renderPage(pageNumber) {
      pdf.getPage(pageNumber).then((page) => {
        const canvas = document.getElementById('pdf-canvas');
        const context = canvas.getContext('2d');

        const viewport = page.getViewport({ scale: currentZoom });

        const canvasWidth = container.clientWidth;
        const canvasHeight = (canvasWidth * viewport.height) / viewport.width;

        canvas.width = canvasWidth;
        canvas.height = canvasHeight;

        const renderContext = {
          canvasContext: context,
          viewport: page.getViewport({ scale: currentZoom }),
        };
        page.render(renderContext);
      });
    }

    function showPage(pageNumber) {
      if (pageNumber <= 0 || pageNumber > pdf.numPages) {
        return;
      }

      currentPage = pageNumber;
      renderPage(currentPage);

      const prevButton = document.getElementById('prev-button');
      const nextButton = document.getElementById('next-button');

      prevButton.style.display = (currentPage === 1) ? 'none' : 'inline-block';
      nextButton.style.display = (currentPage === pdf.numPages) ? 'none' : 'inline-block';

      const pageNumbers = document.getElementById('page-numbers');
      pageNumbers.textContent = `Page ${currentPage} of ${pdf.numPages}`;
    }

    function loadPDF(url) {
      pdfjsLib.getDocument(url).promise.then((loadedPdf) => {
        pdf = loadedPdf;
        showPage(1);
      })
      .catch((error) => {
        console.error('Error loading PDF:', error);
      });
    }

    function openPDF(event) {
      event.preventDefault();
      const pdfUrl = event.target.href;
      loadPDF(pdfUrl);
    }

    const container = document.getElementById('pdf-container');
    const pdfLinksContainer = document.getElementById('pdf-links-container');
    const pdfLinks = pdfLinksContainer.getElementsByClassName('pdf-link');

    Array.from(pdfLinks).forEach((link) => {
      link.addEventListener('click', openPDF);
    });

    const prevButton = document.getElementById('prev-button');
    const nextButton = document.getElementById('next-button');
    const closeButton = document.getElementById('close-button');
    const zoomInButton = document.getElementById('zoom-in-button');
    const zoomOutButton = document.getElementById('zoom-out-button');

    prevButton.addEventListener('click', () => {
      showPage(currentPage - 1);
    });

    nextButton.addEventListener('click', () => {
      showPage(currentPage + 1);
    });

    closeButton.addEventListener('click', () => {
      container.style.display = 'none';
    });

    zoomInButton.addEventListener('click', () => {
      currentZoom += 0.1;
      renderPage(currentPage);
    });

    zoomOutButton.addEventListener('click', () => {
      currentZoom -= 0.1;
      renderPage(currentPage);
    });

    const canvas = document.getElementById('pdf-canvas');

    let startX = 0;
    let startY = 0;
    let initialPinchDistance = 0;
    let initialScale = 1;
    let isDragging = false;

    canvas.addEventListener('touchstart', (event) => {
      if (event.touches.length === 2) {
        // Pinch gesture
        const touch1 = event.touches[0];
        const touch2 = event.touches[1];
        initialPinchDistance = Math.hypot(
          touch2.clientX - touch1.clientX,
          touch2.clientY - touch1.clientY
        );
        initialScale = canvas.style.transform ? parseFloat(canvas.style.transform.split(' ')[1]) : 1;
      } else if (event.touches.length === 1) {
        // Single touch for dragging
        startX = event.touches[0].clientX;
        startY = event.touches[0].clientY;
        isDragging = true;
      }
    });

    canvas.addEventListener('touchmove', (event) => {
      if (event.touches.length === 2) {
        // Pinch gesture
        const touch1 = event.touches[0];
        const touch2 = event.touches[1];
        const currentPinchDistance = Math.hypot(
          touch2.clientX - touch1.clientX,
          touch2.clientY - touch1.clientY
        );
        const deltaDistance = currentPinchDistance - initialPinchDistance;
        const scaleFactor = initialScale + (deltaDistance * 0.01);
        canvas.style.transform = `scale(${scaleFactor})`;
      } else if (event.touches.length === 1 && isDragging) {
        // Single touch for dragging
        const currentX = event.touches[0].clientX;
        const currentY = event.touches[0].clientY;
        const deltaX = currentX - startX;
        const deltaY = currentY - startY;
        canvas.style.transform = `translate(${deltaX}px, ${deltaY}px)`;
      }
    });

    canvas.addEventListener('touchend', () => {
      isDragging = false;
    });

    const currentYearElement = document.getElementById('current-year');
    const currentYear = new Date().getFullYear();
    currentYearElement.textContent = currentYear.toString();
  </script>
</body>
</html>
